#!/usr/bin/env php
<?php

use MultiTester\MultiTester;

set_time_limit(-1);

function includeIfExists($file)
{
    if (file_exists($file)) {
        return include $file;
    }
}

//Check for autoload file

$possibleFolders = array_unique(array_filter(array_map('realpath', [
        getcwd() . '/vendor',
        __DIR__ . '/../vendor',
        __DIR__ . '/../../..'
]), 'file_exists'));

foreach ($possibleFolders as $folder) {
    if (includeIfExists("$folder/autoload.php")) {
        exit((new MultiTester())->run($argv) ? 0 : 1);
    }
}

echo "Composer's autoload.php not found in checked folders:\n - " . implode("\n - ", $possibleFolders) . "\n";
exit(1);
