#!/usr/bin/env php
<?php

use MultiTester\MultiTester;

set_time_limit(-1);

function includeIfExists($file)
{
    if (file_exists($file)) {
        return include $file;
    }
}

function getLoader()
{
    $cwd = getcwd();
    $possibleFolders = ["$cwd/vendor", __DIR__ . '/../vendor', __DIR__ . '/../../..'];
    foreach ($possibleFolders as $dir) {
        if ($loader = includeIfExists($dir . '/autoload.php')) {
            if (class_exists('MultiTester\MultiTester')) {
                return $loader;
            }
            $loader->unregister();
        }
    }
    return false;
}

//Check for autoload file
if (!$loader = getLoader()) {
    echo "Composer's autoload.php file not found.";
    exit(1);
}

exit((new MultiTester())->run($argv) ? 0 : 1);
